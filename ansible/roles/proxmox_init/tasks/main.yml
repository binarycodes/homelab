- name: add proxmox setup scripts
  ansible.builtin.copy:
    src: "{{item}}"
    dest: "/root/{{item}}"
    mode: "u+rwx"
  loop:
    - "terraform-user.sh"
    - "setup-repositories.sh"

- name: add create/delete debian template scripts
  ansible.builtin.template:
    src: "{{item}}"
    dest: "/root/"
    owner: root
    group: root
    mode: u+rwx
  loop:
    - "create-debian12-template.sh"
    - "delete-debian12-template.sh"
  notify:
    - remove-previous-debian-template
    - create-new-debian-template

- name: setup repositories
  ansible.builtin.shell: /root/setup-repositories.sh
  changed_when: false

- name: add realm setup scripts
  ansible.builtin.template:
    src: create-openid-realm.sh
    dest: /root/
    owner: root
    group: root
    mode: u+rwx
  notify:
    - re-create-new-open-id-realm
